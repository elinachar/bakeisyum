$(document).on('turbolinks:load', function() {

  // Set stars according to rating
  var avg = $(".rating").data("rating");
  updateStarClass(avg);

  //Show form for leaving new comment
  $("#create-new-comment").click(function() {
    $(".new-comment").slideDown('slow');
    $("#create-new-comment").prop('disabled', true);
  });

  //Enable Tooltips
  $(function () {
    $('[data-toggle="tooltip"]').tooltip()
  })

  // Enable Lazy loading
  $("img").lazyload({
    threshold : 1000,
    effect : "fadeIn"
  });

  // Disable Lazy Loading when images are cached
  var lazyImages = $('img[data-original]');
  // console.log(cached(lazyImages[0]));
  // console.log(cached($(".recipe img")));
  function cached(url){
    var test = document.createElement("img");
    test.src = url;
    return test.complete || test.width+test.height > 0;
  }

});
